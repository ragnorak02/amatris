<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMATRIS</title>
    <link rel="icon" href="amatris-fire.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/studio.css">
    <link rel="stylesheet" href="css/overlay.css">
</head>
<body>
    <!-- Starry night background layers -->
    <div id="bg-stars" class="bg-layer"></div>
    <div id="bg-clouds" class="bg-layer"></div>
    <div id="logo-icon" title="AMATRIS">
        <svg id="wolf-logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <!-- Wolf head silhouette -->
            <path d="M50 8 L35 28 L20 18 L28 42 L18 52 L32 54 L30 70 L42 62 L50 75 L58 62 L70 70 L68 54 L82 52 L72 42 L80 18 L65 28 L50 8Z" fill="#d4af37" opacity="0.95"/>
            <!-- Flame mane left -->
            <path class="flame-path" d="M25 30 Q20 20 28 15 Q24 25 30 28Z" fill="#f0c850" opacity="0.8" style="animation-delay: 0s"/>
            <path class="flame-path" d="M22 38 Q15 28 20 20 Q18 32 26 36Z" fill="#f0c850" opacity="0.7" style="animation-delay: 0.3s"/>
            <!-- Flame mane right -->
            <path class="flame-path" d="M75 30 Q80 20 72 15 Q76 25 70 28Z" fill="#f0c850" opacity="0.8" style="animation-delay: 0.6s"/>
            <path class="flame-path" d="M78 38 Q85 28 80 20 Q82 32 74 36Z" fill="#f0c850" opacity="0.7" style="animation-delay: 0.9s"/>
            <!-- Flame top -->
            <path class="flame-path" d="M50 8 Q45 -2 50 -5 Q55 -2 50 8Z" fill="#f0c850" opacity="0.75" style="animation-delay: 0.15s"/>
            <path class="flame-path" d="M42 14 Q38 4 44 0 Q40 10 45 14Z" fill="#f0c850" opacity="0.6" style="animation-delay: 0.45s"/>
            <path class="flame-path" d="M58 14 Q62 4 56 0 Q60 10 55 14Z" fill="#f0c850" opacity="0.6" style="animation-delay: 0.75s"/>
            <!-- Eyes -->
            <circle cx="40" cy="42" r="3" fill="#ff6030" opacity="0.95"/>
            <circle cx="60" cy="42" r="3" fill="#ff6030" opacity="0.95"/>
            <circle cx="40" cy="41.5" r="1.2" fill="#fff" opacity="0.9"/>
            <circle cx="60" cy="41.5" r="1.2" fill="#fff" opacity="0.9"/>
            <!-- Snout -->
            <path d="M45 52 L50 58 L55 52" fill="none" stroke="#d4af37" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
    </div>

    <!-- Header -->
    <header id="portal-header">
        <h1 class="logo">AMATRIS</h1>
    </header>

    <!-- Top Mini Menu Bar -->
    <nav id="top-menu">
        <ul id="menu-tabs">
            <li class="menu-tab" data-tab="store">Store</li>
            <li class="menu-tab active" data-tab="library">Library</li>
            <li class="menu-tab" data-tab="news">News</li>
            <li class="menu-tab" data-tab="mods">Mods</li>
            <li class="menu-tab" data-tab="wip">WIP</li>
            <li class="menu-tab" data-tab="patreon">Patreon</li>
            <li class="menu-tab" data-tab="credits">Credits</li>
        </ul>
    </nav>

    <!-- Studio Dashboard -->
    <div id="studio-view">
        <aside id="studio-sidebar">
            <div id="sidebar-header"><span class="sidebar-title">LIBRARY</span></div>
            <div id="sidebar-filters"><!-- Rendered by studio.js --></div>
        </aside>
        <div id="studio-main">
            <div id="studio-toolbar"></div>
            <div id="studio-game-list"></div>
        </div>
    </div>

    <!-- Detail panel overlay (shown when a game is selected) -->
    <div id="studio-detail-panel" class="hidden"></div>

    <!-- File Preview Modal -->
    <div id="file-preview-modal" class="hidden">
        <div class="preview-backdrop"></div>
        <div class="preview-dialog">
            <div class="preview-header">
                <div class="preview-header-left">
                    <span class="preview-type-badge" id="preview-type-badge"></span>
                    <span class="preview-title">File Preview</span>
                </div>
                <button class="preview-close-btn" title="Close">&times;</button>
            </div>
            <div class="preview-content"></div>
            <div class="preview-footer">
                <span class="preview-meta-inline" id="preview-meta-inline"></span>
                <button class="toolbar-btn" id="preview-download-btn">Download</button>
            </div>
        </div>
    </div>

    <!-- ============================================================
         GAME VIEW — Shown when a game is active (replaces studio)
         ============================================================ -->
    <div id="game-view" class="hidden">
        <iframe id="game-iframe" class="hidden" allowfullscreen></iframe>
        <div id="game-external" class="hidden">
            <div class="external-icon"></div>
            <h2 class="external-title"></h2>
            <p class="external-subtitle"></p>
            <div class="external-pulse"></div>
            <p class="external-hint">Press <kbd>Shift</kbd> + <kbd>Tab</kbd> for overlay</p>
        </div>
    </div>

    <!-- Overlay toggle button (visible during gameplay) -->
    <button id="overlay-toggle" class="hidden">Shift+Tab — Overlay</button>

    <!-- ============================================================
         OVERLAY — Toggled with Shift+Tab during gameplay
         ============================================================ -->
    <div id="overlay" class="hidden">
        <div class="overlay-backdrop"></div>

        <!-- Top-Right: Overlay Label -->
        <div id="overlay-label">SHIFT+TAB &mdash; OVERLAY</div>

        <!-- Top-Center: Shortcut Strip -->
        <div id="shortcut-strip">
            <div class="shortcut-tile tile-purple" data-module="game">
                <span class="tile-icon">&#127918;</span>
                <span class="tile-label">Current Game</span>
            </div>
            <div class="shortcut-tile tile-red" data-module="volume">
                <span class="tile-icon">&#128266;</span>
                <span class="tile-label">Volume</span>
            </div>
            <div class="shortcut-tile tile-cyan" data-module="screen">
                <span class="tile-icon">&#128187;</span>
                <span class="tile-label">Screen</span>
            </div>
            <div class="shortcut-tile tile-green" data-module="screenshots">
                <span class="tile-icon">&#128248;</span>
                <span class="tile-label">Screenshots</span>
            </div>
            <div class="shortcut-tile tile-gray" data-module="settings">
                <span class="tile-icon">&#9881;</span>
                <span class="tile-label">Settings</span>
            </div>
        </div>

        <!-- Instructions Banner -->
        <div id="overlay-instructions">
            <div class="instruction-row">
                <span class="instruction-text">Hit <span class="btn-badge btn-b">B</span> to return to Game</span>
            </div>
            <div class="instruction-row">
                <span class="instruction-text">Hold <span class="btn-badge btn-y">Y</span> to exit game and return to AMATRIS</span>
            </div>
        </div>

        <!-- Game Info (icon, name, mode, status dot) -->
        <div id="overlay-game-info">
            <div class="game-info-icon"></div>
            <div class="game-info-name"></div>
            <div class="game-info-mode"></div>
            <div class="status-dot"></div>
        </div>

        <!-- Module Content (center, expands when a tile is clicked) -->
        <div id="module-content" class="hidden"></div>

        <!-- Bottom-Left: Performance Panel -->
        <div id="overlay-perf">
            <div class="perf-header">PERFORMANCE</div>
            <div class="perf-row">
                <span class="perf-label">FPS</span>
                <span class="perf-value" id="perf-fps">--</span>
            </div>
            <div class="perf-row">
                <span class="perf-label">CPU</span>
                <span class="perf-value" id="perf-cpu">--</span>
            </div>
            <div class="perf-row">
                <span class="perf-label">RAM</span>
                <span class="perf-value" id="perf-ram">--</span>
            </div>
        </div>

        <!-- Bottom-Center: Hint -->
        <div id="overlay-bottom-hint">Press <kbd>Shift</kbd> + <kbd>Tab</kbd> for overlay</div>
    </div>

    <!-- Controller Hint Bar (shown when gamepad connected) -->
    <div id="controller-hints" class="hidden"></div>

    <!-- Scripts -->
    <script src="js/input-manager.js"></script>
    <script src="js/game-view.js"></script>
    <script src="js/overlay.js"></script>
    <script src="js/studio.js"></script>
    <script src="js/file-preview.js"></script>
    <script src="js/test-runner.js"></script>
    <script src="js/background.js"></script>
    <script src="js/gamepad.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
